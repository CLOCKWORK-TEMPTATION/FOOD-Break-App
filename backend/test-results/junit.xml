<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="271" failures="144" errors="0" time="10.968">
  <testsuite name="Custom Error Classes" errors="0" failures="1" skipped="0" timestamp="2025-12-28T11:09:54" time="2.33" tests="21">
    <testcase classname="Custom Error Classes ApiError should create base API error" name="Custom Error Classes ApiError should create base API error" time="0.028">
    </testcase>
    <testcase classname="Custom Error Classes ApiError should serialize to JSON correctly" name="Custom Error Classes ApiError should serialize to JSON correctly" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes ApiError should include stack trace in development" name="Custom Error Classes ApiError should include stack trace in development" time="0.017">
    </testcase>
    <testcase classname="Custom Error Classes BadRequestError should create 400 error" name="Custom Error Classes BadRequestError should create 400 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes UnauthorizedError should create 401 error" name="Custom Error Classes UnauthorizedError should create 401 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes ForbiddenError should create 403 error" name="Custom Error Classes ForbiddenError should create 403 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes NotFoundError should create 404 error" name="Custom Error Classes NotFoundError should create 404 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes ConflictError should create 409 error" name="Custom Error Classes ConflictError should create 409 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes ValidationError should create validation error with details" name="Custom Error Classes ValidationError should create validation error with details" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes RateLimitError should create rate limit error with retry time" name="Custom Error Classes RateLimitError should create rate limit error with retry time" time="0">
    </testcase>
    <testcase classname="Custom Error Classes InternalServerError should create 500 error as non-operational" name="Custom Error Classes InternalServerError should create 500 error as non-operational" time="0">
    </testcase>
    <testcase classname="Custom Error Classes ServiceUnavailableError should create 503 error" name="Custom Error Classes ServiceUnavailableError should create 503 error" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes DatabaseError should wrap database errors" name="Custom Error Classes DatabaseError should wrap database errors" time="0">
    </testcase>
    <testcase classname="Custom Error Classes PrismaError should handle P2002 (unique constraint)" name="Custom Error Classes PrismaError should handle P2002 (unique constraint)" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes PrismaError should handle P2025 (record not found)" name="Custom Error Classes PrismaError should handle P2025 (record not found)" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes PrismaError should handle P2003 (foreign key constraint)" name="Custom Error Classes PrismaError should handle P2003 (foreign key constraint)" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes PrismaError should handle unknown Prisma errors" name="Custom Error Classes PrismaError should handle unknown Prisma errors" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes errorHandler utility should handle Prisma errors" name="Custom Error Classes errorHandler utility should handle Prisma errors" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes errorHandler utility should handle JWT errors" name="Custom Error Classes errorHandler utility should handle JWT errors" time="0">
    </testcase>
    <testcase classname="Custom Error Classes errorHandler utility should handle validation errors" name="Custom Error Classes errorHandler utility should handle validation errors" time="0.001">
    </testcase>
    <testcase classname="Custom Error Classes errorHandler utility should log errors with context" name="Custom Error Classes errorHandler utility should log errors with context" time="0.014">
      <failure>Error: expect(received).toHaveBeenCalledWith(...expected)

Matcher error: received value must be a mock or spy function

Received has type:  function
Received has value: [Function warn]
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/utils/errors.test.js:242:27)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Error Handler Middleware" errors="0" failures="5" skipped="0" timestamp="2025-12-28T11:09:54" time="2.35" tests="6">
    <testcase classname="Error Handler Middleware errorHandler should handle Prisma duplicate error" name="Error Handler Middleware errorHandler should handle Prisma duplicate error" time="0.024">
      <failure>TypeError: req.get is not a function
    at get (/home/user/breakapp/backend/src/middleware/errorHandler.js:72:20)
    at Object.errorHandler (/home/user/breakapp/backend/tests/unit/middleware/errorHandler.test.js:23:7)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Error Handler Middleware errorHandler should handle Prisma not found error" name="Error Handler Middleware errorHandler should handle Prisma not found error" time="0.001">
      <failure>TypeError: req.get is not a function
    at get (/home/user/breakapp/backend/src/middleware/errorHandler.js:72:20)
    at Object.errorHandler (/home/user/breakapp/backend/tests/unit/middleware/errorHandler.test.js:36:7)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Error Handler Middleware errorHandler should handle validation error" name="Error Handler Middleware errorHandler should handle validation error" time="0.001">
      <failure>TypeError: req.get is not a function
    at get (/home/user/breakapp/backend/src/middleware/errorHandler.js:72:20)
    at Object.errorHandler (/home/user/breakapp/backend/tests/unit/middleware/errorHandler.test.js:44:7)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Error Handler Middleware errorHandler should handle JWT error" name="Error Handler Middleware errorHandler should handle JWT error" time="0.001">
      <failure>TypeError: req.get is not a function
    at get (/home/user/breakapp/backend/src/middleware/errorHandler.js:72:20)
    at Object.errorHandler (/home/user/breakapp/backend/tests/unit/middleware/errorHandler.test.js:52:7)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Error Handler Middleware errorHandler should sanitize sensitive data" name="Error Handler Middleware errorHandler should sanitize sensitive data" time="0.001">
      <failure>TypeError: req.get is not a function
    at get (/home/user/breakapp/backend/src/middleware/errorHandler.js:72:20)
    at Object.errorHandler (/home/user/breakapp/backend/tests/unit/middleware/errorHandler.test.js:61:7)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Error Handler Middleware notFound should create 404 error" name="Error Handler Middleware notFound should create 404 error" time="0.003">
    </testcase>
  </testsuite>
  <testsuite name="Order Controller" errors="0" failures="4" skipped="0" timestamp="2025-12-28T11:09:54" time="2.406" tests="7">
    <testcase classname="Order Controller createOrder should create order successfully" name="Order Controller createOrder should create order successfully" time="0.031">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;data&quot;: Object {
      &quot;id&quot;: &quot;order-1&quot;,
    },
-   &quot;message&quot;: &quot;تم إنشاء الطلب بنجاح&quot;,
+   &quot;message&quot;: &quot;orders.orderCreated&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/orderController.test.js:37:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Order Controller createOrder should reject order without items" name="Order Controller createOrder should reject order without items" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
-   &quot;error&quot;: &quot;يجب إضافة عنصر واحد على الأقل للطلب&quot;,
+   &quot;error&quot;: &quot;orders.itemsRequired&quot;,
    &quot;success&quot;: false,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/orderController.test.js:50:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Order Controller getOrderById should return order for owner" name="Order Controller getOrderById should return order for owner" time="0.001">
    </testcase>
    <testcase classname="Order Controller getOrderById should reject access for non-owner" name="Order Controller getOrderById should reject access for non-owner" time="0.001">
    </testcase>
    <testcase classname="Order Controller updateOrderStatus should update status for admin" name="Order Controller updateOrderStatus should update status for admin" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;data&quot;: Object {
      &quot;id&quot;: &quot;order-1&quot;,
      &quot;status&quot;: &quot;CONFIRMED&quot;,
    },
-   &quot;message&quot;: &quot;تم تحديث حالة الطلب إلى CONFIRMED&quot;,
+   &quot;message&quot;: &quot;orders.orderStatusUpdated&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/orderController.test.js:89:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Order Controller updateOrderStatus should reject status update for regular user" name="Order Controller updateOrderStatus should reject status update for regular user" time="0.001">
    </testcase>
    <testcase classname="Order Controller cancelOrder should cancel order successfully" name="Order Controller cancelOrder should cancel order successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;data&quot;: Object {
      &quot;id&quot;: &quot;order-1&quot;,
      &quot;status&quot;: &quot;CANCELLED&quot;,
    },
-   &quot;message&quot;: &quot;تم إلغاء الطلب بنجاح&quot;,
+   &quot;message&quot;: &quot;orders.orderCancelled&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/orderController.test.js:114:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Emotion Controller" errors="0" failures="3" skipped="0" timestamp="2025-12-28T11:09:54" time="2.421" tests="5">
    <testcase classname="Emotion Controller logMood should log mood successfully" name="Emotion Controller logMood should log mood successfully" time="0.028">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;data&quot;: Object {
      &quot;id&quot;: &quot;log-1&quot;,
      &quot;mood&quot;: &quot;HAPPY&quot;,
    },
+   &quot;message&quot;: &quot;emotion.moodLogSuccess&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/emotionController.test.js:39:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Emotion Controller logMood should use userId from token only" name="Emotion Controller logMood should use userId from token only" time="0.001">
    </testcase>
    <testcase classname="Emotion Controller getRecommendations should get recommendations successfully" name="Emotion Controller getRecommendations should get recommendations successfully" time="0">
    </testcase>
    <testcase classname="Emotion Controller getRecommendations should reject request without mood" name="Emotion Controller getRecommendations should reject request without mood" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
-   &quot;message&quot;: &quot;Mood is required&quot;,
+   &quot;error&quot;: Object {
+     &quot;code&quot;: &quot;MOOD_REQUIRED&quot;,
+     &quot;message&quot;: &quot;emotion.moodRequired&quot;,
+   },
+   &quot;success&quot;: false,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/emotionController.test.js:76:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Emotion Controller updateConsent should update consent successfully" name="Emotion Controller updateConsent should update consent successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
    &quot;data&quot;: Object {
      &quot;id&quot;: &quot;consent-1&quot;,
    },
+   &quot;message&quot;: &quot;emotion.consentUpdated&quot;,
    &quot;success&quot;: true,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/emotionController.test.js:99:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Notification Service" errors="0" failures="14" skipped="0" timestamp="2025-12-28T11:09:54" time="2.436" tests="14">
    <testcase classname="Notification Service getUserNotifications should return user notifications with pagination" name="Notification Service getUserNotifications should return user notifications with pagination" time="0.025">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:27:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service getUserNotifications should filter by unread status" name="Notification Service getUserNotifications should filter by unread status" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:43:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service createNotification should create notification successfully" name="Notification Service createNotification should create notification successfully" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:68:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service createNotification should link to order if orderId provided" name="Notification Service createNotification should link to order if orderId provided" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:87:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service markAsRead should mark notification as read" name="Notification Service markAsRead should mark notification as read" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:115:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service markAsRead should return null if notification not found" name="Notification Service markAsRead should return null if notification not found" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:132:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service markAllAsRead should mark all user notifications as read" name="Notification Service markAllAsRead should mark all user notifications as read" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:142:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service deleteNotification should delete notification" name="Notification Service deleteNotification should delete notification" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:164:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service deleteNotification should return false on error" name="Notification Service deleteNotification should return false on error" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:172:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service sendPushNotification should send push notification successfully" name="Notification Service sendPushNotification should send push notification successfully" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:190:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service sendPushNotification should return false if notification not found" name="Notification Service sendPushNotification should return false if notification not found" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;notification&apos;)
    at Object.notification (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:198:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service getPreferences should return user preferences with defaults" name="Notification Service getPreferences should return user preferences with defaults" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;userReminderPreferences&apos;)
    at Object.userReminderPreferences (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:215:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service getPreferences should return default preferences if none exist" name="Notification Service getPreferences should return default preferences if none exist" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;userReminderPreferences&apos;)
    at Object.userReminderPreferences (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:223:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Service updatePreferences should update existing preferences" name="Notification Service updatePreferences should update existing preferences" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;userReminderPreferences&apos;)
    at Object.userReminderPreferences (/home/user/breakapp/backend/tests/unit/services/notificationService.test.js:243:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Notification Controller" errors="0" failures="14" skipped="0" timestamp="2025-12-28T11:09:54" time="2.44" tests="14">
    <testcase classname="Notification Controller getNotifications should return user notifications" name="Notification Controller getNotifications should return user notifications" time="0.024">
      <failure>TypeError: notificationController.getNotifications is not a function
    at Object.getNotifications (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:48:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller getNotifications should filter unread notifications when requested" name="Notification Controller getNotifications should filter unread notifications when requested" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:60:50)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller getNotifications should paginate results" name="Notification Controller getNotifications should paginate results" time="0">
      <failure>TypeError: notificationController.getNotifications is not a function
    at Object.getNotifications (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:73:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller markAsRead should mark notification as read" name="Notification Controller markAsRead should mark notification as read" time="0.003">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:97:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Notification Controller markAsRead should return 404 for non-existent notification" name="Notification Controller markAsRead should return 404 for non-existent notification" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;0&apos;)
    at Object.&lt;anonymous&gt; (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:111:43)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Notification Controller markAllAsRead should mark all notifications as read" name="Notification Controller markAllAsRead should mark all notifications as read" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:122:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Notification Controller createNotification should create notification successfully" name="Notification Controller createNotification should create notification successfully" time="0">
      <failure>TypeError: notificationController.createNotification is not a function
    at Object.createNotification (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:148:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller createNotification should validate required fields" name="Notification Controller createNotification should validate required fields" time="0">
      <failure>TypeError: notificationController.createNotification is not a function
    at Object.createNotification (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:160:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller deleteNotification should delete notification" name="Notification Controller deleteNotification should delete notification" time="0">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:174:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Notification Controller deleteNotification should handle not found error" name="Notification Controller deleteNotification should handle not found error" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;0&apos;)
    at Object.&lt;anonymous&gt; (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:188:43)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Notification Controller sendPushNotification should send push notification" name="Notification Controller sendPushNotification should send push notification" time="0.001">
      <failure>TypeError: notificationController.sendPushNotification is not a function
    at Object.sendPushNotification (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:199:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller sendPushNotification should handle push send failure" name="Notification Controller sendPushNotification should handle push send failure" time="0">
      <failure>TypeError: notificationController.sendPushNotification is not a function
    at Object.sendPushNotification (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:213:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller getNotificationPreferences should return notification preferences" name="Notification Controller getNotificationPreferences should return notification preferences" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:227:42)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Notification Controller updateNotificationPreferences should update notification preferences" name="Notification Controller updateNotificationPreferences should update notification preferences" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/notificationController.test.js:252:45)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Medical Service" errors="0" failures="16" skipped="0" timestamp="2025-12-28T11:09:54" time="2.469" tests="16">
    <testcase classname="Medical Service createOrUpdateMedicalProfile should create medical profile with encryption" name="Medical Service createOrUpdateMedicalProfile should create medical profile with encryption" time="0.029">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;upsert&apos;)
    at Object.upsert [as createOrUpdateMedicalProfile] (/home/user/breakapp/backend/src/services/medicalService.js:20:56)
    at Object.createOrUpdateMedicalProfile (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:87:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service createOrUpdateMedicalProfile should update existing medical profile" name="Medical Service createOrUpdateMedicalProfile should update existing medical profile" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;upsert&apos;)
    at Object.upsert [as createOrUpdateMedicalProfile] (/home/user/breakapp/backend/src/services/medicalService.js:20:56)
    at Object.createOrUpdateMedicalProfile (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:120:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service createOrUpdateMedicalProfile should require consent for medical data processing" name="Medical Service createOrUpdateMedicalProfile should require consent for medical data processing" time="0.018">
      <failure>Error: expect(received).rejects.toThrow(expected)

Expected substring: &quot;Consent required for medical data processing&quot;
Received message:   &quot;Cannot read properties of undefined (reading &apos;upsert&apos;)&quot;

      18 |     const encryptedData = encryptMedicalData(profileData);
      19 |
    &gt; 20 |     const medicalProfile = await prisma.medicalProfile.upsert({
         |                                                        ^
      21 |       where: { userId },
      22 |       update: {
      23 |         ...encryptedData,

      at Object.upsert [as createOrUpdateMedicalProfile] (src/services/medicalService.js:20:56)
      at Object.createOrUpdateMedicalProfile (tests/unit/services/medicalService.test.js:137:35)
    at Object.toThrow (/home/user/breakapp/backend/node_modules/jest-circus/node_modules/expect/build/index.js:218:22)
    at Object.toThrow (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:138:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service getMedicalProfile should return decrypted medical profile" name="Medical Service getMedicalProfile should return decrypted medical profile" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at Object.findUnique [as getMedicalProfile] (/home/user/breakapp/backend/src/services/medicalService.js:51:49)
    at Object.getMedicalProfile (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:153:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service getMedicalProfile should return null for non-existent profile" name="Medical Service getMedicalProfile should return null for non-existent profile" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at Object.findUnique [as getMedicalProfile] (/home/user/breakapp/backend/src/services/medicalService.js:51:49)
    at Object.getMedicalProfile (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:168:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service checkItemForMedicalAlerts should check menu item for medical alerts" name="Medical Service checkItemForMedicalAlerts should check menu item for medical alerts" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at findUnique (/home/user/breakapp/backend/src/services/medicalService.js:51:49)
    at Object.getMedicalProfile [as checkItemForMedicalAlerts] (/home/user/breakapp/backend/src/services/medicalService.js:83:34)
    at Object.checkItemForMedicalAlerts (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:199:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service checkItemForMedicalAlerts should check ingredients directly" name="Medical Service checkItemForMedicalAlerts should check ingredients directly" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at findUnique (/home/user/breakapp/backend/src/services/medicalService.js:51:49)
    at Object.getMedicalProfile [as checkItemForMedicalAlerts] (/home/user/breakapp/backend/src/services/medicalService.js:83:34)
    at Object.checkItemForMedicalAlerts (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:233:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service checkItemForMedicalAlerts should return no alerts for users without medical profile" name="Medical Service checkItemForMedicalAlerts should return no alerts for users without medical profile" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at findUnique (/home/user/breakapp/backend/src/services/medicalService.js:51:49)
    at Object.getMedicalProfile [as checkItemForMedicalAlerts] (/home/user/breakapp/backend/src/services/medicalService.js:83:34)
    at Object.checkItemForMedicalAlerts (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:247:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service reportMedicalIncident should report medical incident successfully" name="Medical Service reportMedicalIncident should report medical incident successfully" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;create&apos;)
    at Object.create [as reportMedicalIncident] (/home/user/breakapp/backend/src/services/medicalService.js:190:51)
    at Object.reportMedicalIncident (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:278:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service reportMedicalIncident should handle critical incidents with emergency contact notification" name="Medical Service reportMedicalIncident should handle critical incidents with emergency contact notification" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;create&apos;)
    at Object.create [as reportMedicalIncident] (/home/user/breakapp/backend/src/services/medicalService.js:190:51)
    at Object.reportMedicalIncident (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:315:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service getMedicalIncidents should return paginated medical incidents" name="Medical Service getMedicalIncidents should return paginated medical incidents" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findMany&apos;)
    at Object.findMany [as getMedicalIncidents] (/home/user/breakapp/backend/src/services/medicalService.js:300:30)
    at Object.getMedicalIncidents (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:346:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service updateMedicalConsent should update medical consent" name="Medical Service updateMedicalConsent should update medical consent" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;upsert&apos;)
    at Object.upsert [as updateMedicalConsent] (/home/user/breakapp/backend/src/services/medicalService.js:340:49)
    at Object.updateMedicalConsent (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:375:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service exportMedicalData should export all medical data for GDPR compliance" name="Medical Service exportMedicalData should export all medical data for GDPR compliance" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:415:42)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service deleteMedicalData should delete all medical data for GDPR right to be forgotten" name="Medical Service deleteMedicalData should delete all medical data for GDPR right to be forgotten" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:434:45)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service addIngredient should add new ingredient to database" name="Medical Service addIngredient should add new ingredient to database" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;create&apos;)
    at Object.create [as addIngredient] (/home/user/breakapp/backend/src/services/medicalService.js:396:48)
    at Object.addIngredient (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:475:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Service searchIngredients should search ingredients by name and category" name="Medical Service searchIngredients should search ingredients by name and category" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findMany&apos;)
    at Object.findMany [as searchIngredients] (/home/user/breakapp/backend/src/services/medicalService.js:432:49)
    at Object.searchIngredients (/home/user/breakapp/backend/tests/unit/services/medicalService.test.js:503:43)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Menu Controller" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.201" tests="6">
    <testcase classname="Menu Controller getAllMenuItems should return all menu items" name="Menu Controller getAllMenuItems should return all menu items" time="0.002">
    </testcase>
    <testcase classname="Menu Controller getGeographicMenu should return geographic menu with coordinates" name="Menu Controller getGeographicMenu should return geographic menu with coordinates" time="0.001">
    </testcase>
    <testcase classname="Menu Controller getGeographicMenu should reject request without coordinates" name="Menu Controller getGeographicMenu should reject request without coordinates" time="0.001">
    </testcase>
    <testcase classname="Menu Controller searchMenuItems should search menu items" name="Menu Controller searchMenuItems should search menu items" time="0">
    </testcase>
    <testcase classname="Menu Controller searchMenuItems should reject search without query" name="Menu Controller searchMenuItems should reject search without query" time="0.001">
    </testcase>
    <testcase classname="Menu Controller createMenuItem should create menu item" name="Menu Controller createMenuItem should create menu item" time="0.005">
    </testcase>
  </testsuite>
  <testsuite name="Restaurant Controller" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.199" tests="3">
    <testcase classname="Restaurant Controller getNearbyRestaurants should return nearby restaurants" name="Restaurant Controller getNearbyRestaurants should return nearby restaurants" time="0.002">
    </testcase>
    <testcase classname="Restaurant Controller getNearbyRestaurants should reject without coordinates" name="Restaurant Controller getNearbyRestaurants should reject without coordinates" time="0.001">
    </testcase>
    <testcase classname="Restaurant Controller createRestaurant should create restaurant" name="Restaurant Controller createRestaurant should create restaurant" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Exception Controller" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.226" tests="5">
    <testcase classname="Exception Controller checkEligibility should check exception eligibility" name="Exception Controller checkEligibility should check exception eligibility" time="0.002">
    </testcase>
    <testcase classname="Exception Controller checkEligibility should reject without exception type" name="Exception Controller checkEligibility should reject without exception type" time="0.001">
    </testcase>
    <testcase classname="Exception Controller calculateCost should calculate exception cost" name="Exception Controller calculateCost should calculate exception cost" time="0.001">
    </testcase>
    <testcase classname="Exception Controller calculateCost should reject without required fields" name="Exception Controller calculateCost should reject without required fields" time="0.001">
    </testcase>
    <testcase classname="Exception Controller generateFinancialReport should generate financial report" name="Exception Controller generateFinancialReport should generate financial report" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Emergency Service" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.213" tests="10">
    <testcase classname="Emergency Service activateEmergencyMode should activate emergency mode successfully" name="Emergency Service activateEmergencyMode should activate emergency mode successfully" time="0.003">
    </testcase>
    <testcase classname="Emergency Service activateEmergencyMode should prevent multiple active emergencies for same project" name="Emergency Service activateEmergencyMode should prevent multiple active emergencies for same project" time="0.026">
    </testcase>
    <testcase classname="Emergency Service createEmergencyOrder should create emergency order with high priority" name="Emergency Service createEmergencyOrder should create emergency order with high priority" time="0.001">
    </testcase>
    <testcase classname="Emergency Service getEmergencyRestaurants should return emergency partner restaurants within radius" name="Emergency Service getEmergencyRestaurants should return emergency partner restaurants within radius" time="0.002">
    </testcase>
    <testcase classname="Emergency Service updateEmergencyOrderStatus should update emergency order status" name="Emergency Service updateEmergencyOrderStatus should update emergency order status" time="0.001">
    </testcase>
    <testcase classname="Emergency Service getPrePreparedInventory should return pre-prepared inventory for project" name="Emergency Service getPrePreparedInventory should return pre-prepared inventory for project" time="0.001">
    </testcase>
    <testcase classname="Emergency Service deactivateEmergencyMode should deactivate emergency mode successfully" name="Emergency Service deactivateEmergencyMode should deactivate emergency mode successfully" time="0">
    </testcase>
    <testcase classname="Emergency Service deactivateEmergencyMode should handle no active emergency" name="Emergency Service deactivateEmergencyMode should handle no active emergency" time="0">
    </testcase>
    <testcase classname="Emergency Service getEmergencyHistory should return paginated emergency history" name="Emergency Service getEmergencyHistory should return paginated emergency history" time="0.001">
    </testcase>
    <testcase classname="Emergency Service notifyScheduleChange should send schedule change notifications" name="Emergency Service notifyScheduleChange should send schedule change notifications" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Payment Service" errors="0" failures="8" skipped="0" timestamp="2025-12-28T11:09:54" time="2.868" tests="23">
    <testcase classname="Payment Service createPaymentIntent should create payment intent with valid amount" name="Payment Service createPaymentIntent should create payment intent with valid amount" time="0.026">
    </testcase>
    <testcase classname="Payment Service createPaymentIntent should handle minimum amount validation" name="Payment Service createPaymentIntent should handle minimum amount validation" time="0.001">
    </testcase>
    <testcase classname="Payment Service createPaymentIntent should attach customer metadata" name="Payment Service createPaymentIntent should attach customer metadata" time="0">
    </testcase>
    <testcase classname="Payment Service processPayment should process successful payment" name="Payment Service processPayment should process successful payment" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:104:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service processPayment should handle payment failure" name="Payment Service processPayment should handle payment failure" time="0.001">
    </testcase>
    <testcase classname="Payment Service processPayment should store payment record on success" name="Payment Service processPayment should store payment record on success" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:141:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service refundPayment should process full refund" name="Payment Service refundPayment should process full refund" time="0.001">
    </testcase>
    <testcase classname="Payment Service refundPayment should process partial refund" name="Payment Service refundPayment should process partial refund" time="0">
    </testcase>
    <testcase classname="Payment Service refundPayment should update payment status after refund" name="Payment Service refundPayment should update payment status after refund" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:195:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service getPaymentStatus should return payment status" name="Payment Service getPaymentStatus should return payment status" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:218:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service getPaymentStatus should return pending status for incomplete payment" name="Payment Service getPaymentStatus should return pending status for incomplete payment" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:228:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service validatePayment should validate payment amount matches order total" name="Payment Service validatePayment should validate payment amount matches order total" time="0">
    </testcase>
    <testcase classname="Payment Service validatePayment should reject payment amount mismatch" name="Payment Service validatePayment should reject payment amount mismatch" time="0.001">
    </testcase>
    <testcase classname="Payment Service validatePayment should validate currency" name="Payment Service validatePayment should validate currency" time="0.001">
    </testcase>
    <testcase classname="Payment Service getUserPayments should return user payment history" name="Payment Service getUserPayments should return user payment history" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:274:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service getUserPayments should include order details" name="Payment Service getUserPayments should include order details" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:290:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Payment Service payment security should not expose full card number" name="Payment Service payment security should not expose full card number" time="0.001">
    </testcase>
    <testcase classname="Payment Service payment security should use secure payment intent" name="Payment Service payment security should use secure payment intent" time="0.001">
    </testcase>
    <testcase classname="Payment Service payment security should validate webhook signature" name="Payment Service payment security should validate webhook signature" time="0.001">
    </testcase>
    <testcase classname="Payment Service currency handling should convert to smallest currency unit" name="Payment Service currency handling should convert to smallest currency unit" time="0">
    </testcase>
    <testcase classname="Payment Service currency handling should handle decimal precision" name="Payment Service currency handling should handle decimal precision" time="0">
    </testcase>
    <testcase classname="Payment Service payment providers should support Stripe provider" name="Payment Service payment providers should support Stripe provider" time="0.001">
    </testcase>
    <testcase classname="Payment Service payment providers should store provider information" name="Payment Service payment providers should store provider information" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;payment&apos;)
    at Object.payment (/home/user/breakapp/backend/tests/unit/services/paymentService.test.js:362:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Admin API Integration Tests" errors="0" failures="18" skipped="0" timestamp="2025-12-28T11:09:54" time="2.914" tests="33">
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/stats should return dashboard statistics for admin" name="Admin API Integration Tests GET /api/v1/admin/stats should return dashboard statistics for admin" time="0.028">
      <failure>TypeError: mockPrisma.order.count.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:32:30)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/stats should return revenue statistics" name="Admin API Integration Tests GET /api/v1/admin/stats should return revenue statistics" time="0.003">
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/stats should return order status breakdown" name="Admin API Integration Tests GET /api/v1/admin/stats should return order status breakdown" time="0.002">
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/stats should deny access to regular users" name="Admin API Integration Tests GET /api/v1/admin/stats should deny access to regular users" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/stats should allow access to producer" name="Admin API Integration Tests GET /api/v1/admin/stats should allow access to producer" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/orders should return all orders for admin" name="Admin API Integration Tests GET /api/v1/admin/orders should return all orders for admin" time="0.001">
      <failure>TypeError: mockPrisma.order.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:94:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by status" name="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by status" time="0.001">
      <failure>TypeError: mockPrisma.order.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:104:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by date range" name="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by date range" time="0.001">
      <failure>TypeError: mockPrisma.order.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:117:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by restaurant" name="Admin API Integration Tests GET /api/v1/admin/orders should support filtering by restaurant" time="0.002">
      <failure>TypeError: mockPrisma.order.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:132:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/orders should include pagination" name="Admin API Integration Tests GET /api/v1/admin/orders should include pagination" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should update order status" name="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should update order status" time="0.001">
      <failure>TypeError: mockPrisma.order.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:158:31)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should validate status transition" name="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should validate status transition" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should record status change timestamp" name="Admin API Integration Tests PUT /api/v1/admin/orders/:id/status should record status change timestamp" time="0.001">
      <failure>TypeError: mockPrisma.order.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:182:31)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/restaurants should return all restaurants" name="Admin API Integration Tests GET /api/v1/admin/restaurants should return all restaurants" time="0.001">
      <failure>TypeError: mockPrisma.restaurant.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:203:38)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/restaurants should include restaurant statistics" name="Admin API Integration Tests GET /api/v1/admin/restaurants should include restaurant statistics" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/restaurants/:id/toggle should toggle restaurant active status" name="Admin API Integration Tests PUT /api/v1/admin/restaurants/:id/toggle should toggle restaurant active status" time="0.001">
      <failure>TypeError: mockPrisma.restaurant.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:231:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/restaurants/:id/toggle should activate inactive restaurant" name="Admin API Integration Tests PUT /api/v1/admin/restaurants/:id/toggle should activate inactive restaurant" time="0.001">
      <failure>TypeError: mockPrisma.restaurant.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:245:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/restaurants/:id/menu should return restaurant menu items" name="Admin API Integration Tests GET /api/v1/admin/restaurants/:id/menu should return restaurant menu items" time="0">
      <failure>TypeError: mockPrisma.menuItem.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:265:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/menu/:id should update menu item details" name="Admin API Integration Tests PUT /api/v1/admin/menu/:id should update menu item details" time="0">
      <failure>TypeError: mockPrisma.menuItem.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:285:34)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/menu/:id should validate price is positive" name="Admin API Integration Tests PUT /api/v1/admin/menu/:id should validate price is positive" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/menu/:id/toggle should toggle menu item availability" name="Admin API Integration Tests PUT /api/v1/admin/menu/:id/toggle should toggle menu item availability" time="0.001">
      <failure>TypeError: mockPrisma.menuItem.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:317:34)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/users should return all users for admin" name="Admin API Integration Tests GET /api/v1/admin/users should return all users for admin" time="0">
      <failure>TypeError: mockPrisma.user.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:337:32)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/users should support filtering by role" name="Admin API Integration Tests GET /api/v1/admin/users should support filtering by role" time="0">
      <failure>TypeError: mockPrisma.user.findMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:345:32)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests GET /api/v1/admin/users should not expose password hashes" name="Admin API Integration Tests GET /api/v1/admin/users should not expose password hashes" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/users/:id/toggle should toggle user active status" name="Admin API Integration Tests PUT /api/v1/admin/users/:id/toggle should toggle user active status" time="0.001">
      <failure>TypeError: mockPrisma.user.update.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:373:30)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests PUT /api/v1/admin/users/:id/toggle should not allow admin to deactivate themselves" name="Admin API Integration Tests PUT /api/v1/admin/users/:id/toggle should not allow admin to deactivate themselves" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests POST /api/v1/admin/notifications/send should send notification to user" name="Admin API Integration Tests POST /api/v1/admin/notifications/send should send notification to user" time="0.001">
      <failure>TypeError: mockPrisma.notification.create.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:407:38)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests POST /api/v1/admin/notifications/send should send bulk notification to all users" name="Admin API Integration Tests POST /api/v1/admin/notifications/send should send bulk notification to all users" time="0.001">
      <failure>TypeError: mockPrisma.notification.createMany.mockResolvedValue is not a function
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/integration/api/admin.test.js:424:42)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Admin API Integration Tests Authorization should require ADMIN or PRODUCER role" name="Admin API Integration Tests Authorization should require ADMIN or PRODUCER role" time="0.005">
    </testcase>
    <testcase classname="Admin API Integration Tests Authorization should reject requests without token" name="Admin API Integration Tests Authorization should reject requests without token" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests Authorization should reject requests with invalid token" name="Admin API Integration Tests Authorization should reject requests with invalid token" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests Authorization should reject requests from regular users" name="Admin API Integration Tests Authorization should reject requests from regular users" time="0.001">
    </testcase>
    <testcase classname="Admin API Integration Tests Audit Logging should log admin actions" name="Admin API Integration Tests Audit Logging should log admin actions" time="0">
    </testcase>
  </testsuite>
  <testsuite name="Voice Controller" errors="0" failures="15" skipped="0" timestamp="2025-12-28T11:09:54" time="2.921" tests="16">
    <testcase classname="Voice Controller processVoiceCommand should process voice command successfully" name="Voice Controller processVoiceCommand should process voice command successfully" time="0.026">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200
Received: 500

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:47:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller processVoiceCommand should handle low confidence transcription" name="Voice Controller processVoiceCommand should handle low confidence transcription" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200
Received: 500

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:72:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller processVoiceCommand should handle voice processing errors" name="Voice Controller processVoiceCommand should handle voice processing errors" time="0.006">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

- Expected
+ Received

  Object {
-   &quot;error&quot;: ObjectContaining {
-     &quot;code&quot;: &quot;VOICE_PROCESSING_FAILED&quot;,
-     &quot;message&quot;: Any&lt;String&gt;,
+   &quot;error&quot;: Object {
+     &quot;code&quot;: &quot;VOICE_PROCESSING_ERROR&quot;,
+     &quot;message&quot;: &quot;voice.processingFailed&quot;,
    },
    &quot;success&quot;: false,
  },

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:89:28)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller confirmVoiceOrder should confirm voice order successfully" name="Voice Controller confirmVoiceOrder should confirm voice order successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:120:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller confirmVoiceOrder should handle order cancellation" name="Voice Controller confirmVoiceOrder should handle order cancellation" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:138:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller getUsualOrder should return user usual order" name="Voice Controller getUsualOrder should return user usual order" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:160:34)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Controller getUsualOrder should handle no usual order found" name="Voice Controller getUsualOrder should handle no usual order found" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:172:34)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Controller voiceSearchMenu should search menu items by voice query" name="Voice Controller voiceSearchMenu should search menu items by voice query" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:209:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller textToSpeech should convert text to speech successfully" name="Voice Controller textToSpeech should convert text to speech successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200
Received: 500

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:236:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller setVoicePreferences should set voice preferences successfully" name="Voice Controller setVoicePreferences should set voice preferences successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:268:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller getVoicePreferences should return voice preferences" name="Voice Controller getVoicePreferences should return voice preferences" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:290:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller createVoiceShortcut should create voice shortcut successfully" name="Voice Controller createVoiceShortcut should create voice shortcut successfully" time="0.001">
    </testcase>
    <testcase classname="Voice Controller getVoiceShortcuts should return user voice shortcuts" name="Voice Controller getVoiceShortcuts should return user voice shortcuts" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:349:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller trainPersonalVoiceModel should train personal voice model successfully" name="Voice Controller trainPersonalVoiceModel should train personal voice model successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:381:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller trainPersonalVoiceModel should require minimum voice samples" name="Voice Controller trainPersonalVoiceModel should require minimum voice samples" time="0.005">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 500
Received: 400

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:400:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Controller getVoiceAnalytics should return voice usage analytics" name="Voice Controller getVoiceAnalytics should return voice usage analytics" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/voiceController.test.js:434:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Medical Controller" errors="0" failures="10" skipped="0" timestamp="2025-12-28T11:09:54" time="2.932" tests="15">
    <testcase classname="Medical Controller createOrUpdateMedicalProfile should create medical profile successfully" name="Medical Controller createOrUpdateMedicalProfile should create medical profile successfully" time="0.024">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:44:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller createOrUpdateMedicalProfile should require consent for medical data processing" name="Medical Controller createOrUpdateMedicalProfile should require consent for medical data processing" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 500
Received: 400

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:64:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller getMedicalProfile should return medical profile successfully" name="Medical Controller getMedicalProfile should return medical profile successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:92:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller getMedicalProfile should handle missing medical profile" name="Medical Controller getMedicalProfile should handle missing medical profile" time="0.001">
    </testcase>
    <testcase classname="Medical Controller checkItemForMedicalAlerts should return medical alerts for menu item" name="Medical Controller checkItemForMedicalAlerts should return medical alerts for menu item" time="0.004">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200
Received: 500

Number of calls: 1
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:138:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller checkItemForMedicalAlerts should check ingredients directly" name="Medical Controller checkItemForMedicalAlerts should check ingredients directly" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:160:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller reportMedicalIncident should report medical incident successfully" name="Medical Controller reportMedicalIncident should report medical incident successfully" time="0.001">
    </testcase>
    <testcase classname="Medical Controller reportMedicalIncident should handle critical incidents with emergency contact" name="Medical Controller reportMedicalIncident should handle critical incidents with emergency contact" time="0.001">
    </testcase>
    <testcase classname="Medical Controller getMedicalIncidents should return medical incidents with pagination" name="Medical Controller getMedicalIncidents should return medical incidents with pagination" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:253:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller updateMedicalConsent should update medical consent successfully" name="Medical Controller updateMedicalConsent should update medical consent successfully" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:282:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller exportMedicalData should export medical data for GDPR compliance" name="Medical Controller exportMedicalData should export medical data for GDPR compliance" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:303:40)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Medical Controller deleteMedicalData should delete medical data for GDPR right to be forgotten" name="Medical Controller deleteMedicalData should delete medical data for GDPR right to be forgotten" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:326:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Medical Controller deleteMedicalData should require confirmation for deletion" name="Medical Controller deleteMedicalData should require confirmation for deletion" time="0.001">
    </testcase>
    <testcase classname="Medical Controller addIngredient should add new ingredient (Admin only)" name="Medical Controller addIngredient should add new ingredient (Admin only)" time="0.001">
    </testcase>
    <testcase classname="Medical Controller searchIngredients should search ingredients successfully" name="Medical Controller searchIngredients should search ingredients successfully" time="0.005">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: 200

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/medicalController.test.js:403:30)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Menu Service" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.68" tests="21">
    <testcase classname="Menu Service getMenuItems should return all available menu items for restaurant" name="Menu Service getMenuItems should return all available menu items for restaurant" time="0.001">
    </testcase>
    <testcase classname="Menu Service getMenuItems should filter by category" name="Menu Service getMenuItems should filter by category" time="0.001">
    </testcase>
    <testcase classname="Menu Service getMenuItems should support search by name" name="Menu Service getMenuItems should support search by name" time="0">
    </testcase>
    <testcase classname="Menu Service getMenuItems should return empty array for restaurant with no items" name="Menu Service getMenuItems should return empty array for restaurant with no items" time="0.001">
    </testcase>
    <testcase classname="Menu Service getMenuItemById should return menu item with restaurant info" name="Menu Service getMenuItemById should return menu item with restaurant info" time="0.001">
    </testcase>
    <testcase classname="Menu Service getMenuItemById should return null for non-existent item" name="Menu Service getMenuItemById should return null for non-existent item" time="0">
    </testcase>
    <testcase classname="Menu Service getCoreMenu should return CORE menu items from partner restaurants" name="Menu Service getCoreMenu should return CORE menu items from partner restaurants" time="0.007">
    </testcase>
    <testcase classname="Menu Service getCoreMenu should sort by quality score" name="Menu Service getCoreMenu should sort by quality score" time="0">
    </testcase>
    <testcase classname="Menu Service getCategories should return unique categories" name="Menu Service getCategories should return unique categories" time="0.001">
    </testcase>
    <testcase classname="Menu Service createMenuItem should create menu item with valid data" name="Menu Service createMenuItem should create menu item with valid data" time="0.001">
    </testcase>
    <testcase classname="Menu Service createMenuItem should require restaurant ID" name="Menu Service createMenuItem should require restaurant ID" time="0">
    </testcase>
    <testcase classname="Menu Service createMenuItem should require positive price" name="Menu Service createMenuItem should require positive price" time="0.001">
    </testcase>
    <testcase classname="Menu Service updateMenuItem should update menu item price" name="Menu Service updateMenuItem should update menu item price" time="0">
    </testcase>
    <testcase classname="Menu Service updateMenuItem should update availability status" name="Menu Service updateMenuItem should update availability status" time="0.001">
    </testcase>
    <testcase classname="Menu Service deleteMenuItem should delete menu item" name="Menu Service deleteMenuItem should delete menu item" time="0">
    </testcase>
    <testcase classname="Menu Service deleteMenuItem should handle deletion of non-existent item" name="Menu Service deleteMenuItem should handle deletion of non-existent item" time="0.016">
    </testcase>
    <testcase classname="Menu Service dietary information should filter vegetarian items" name="Menu Service dietary information should filter vegetarian items" time="0">
    </testcase>
    <testcase classname="Menu Service dietary information should filter gluten-free items" name="Menu Service dietary information should filter gluten-free items" time="0">
    </testcase>
    <testcase classname="Menu Service dietary information should filter by allergens" name="Menu Service dietary information should filter by allergens" time="0.001">
    </testcase>
    <testcase classname="Menu Service pricing should calculate price with modifiers" name="Menu Service pricing should calculate price with modifiers" time="0">
    </testcase>
    <testcase classname="Menu Service pricing should handle discount pricing" name="Menu Service pricing should handle discount pricing" time="0">
    </testcase>
  </testsuite>
  <testsuite name="Emergency Controller" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.765" tests="16">
    <testcase classname="Emergency Controller activateEmergencyMode should activate emergency mode successfully" name="Emergency Controller activateEmergencyMode should activate emergency mode successfully" time="0.002">
    </testcase>
    <testcase classname="Emergency Controller activateEmergencyMode should handle missing required fields" name="Emergency Controller activateEmergencyMode should handle missing required fields" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller activateEmergencyMode should handle activation errors" name="Emergency Controller activateEmergencyMode should handle activation errors" time="0.008">
    </testcase>
    <testcase classname="Emergency Controller createEmergencyOrder should create emergency order successfully" name="Emergency Controller createEmergencyOrder should create emergency order successfully" time="0.002">
    </testcase>
    <testcase classname="Emergency Controller createEmergencyOrder should handle no active emergency session" name="Emergency Controller createEmergencyOrder should handle no active emergency session" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller createEmergencyOrder should validate urgency level" name="Emergency Controller createEmergencyOrder should validate urgency level" time="0.002">
    </testcase>
    <testcase classname="Emergency Controller getEmergencyRestaurants should return emergency restaurants" name="Emergency Controller getEmergencyRestaurants should return emergency restaurants" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller getEmergencyRestaurants should handle missing coordinates" name="Emergency Controller getEmergencyRestaurants should handle missing coordinates" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller updateEmergencyOrderStatus should update emergency order status" name="Emergency Controller updateEmergencyOrderStatus should update emergency order status" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller updateEmergencyOrderStatus should handle missing status" name="Emergency Controller updateEmergencyOrderStatus should handle missing status" time="0">
    </testcase>
    <testcase classname="Emergency Controller getPrePreparedInventory should return pre-prepared inventory" name="Emergency Controller getPrePreparedInventory should return pre-prepared inventory" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller getPrePreparedInventory should handle missing project ID" name="Emergency Controller getPrePreparedInventory should handle missing project ID" time="0">
    </testcase>
    <testcase classname="Emergency Controller addToPrePreparedInventory should add item to inventory successfully" name="Emergency Controller addToPrePreparedInventory should add item to inventory successfully" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller deactivateEmergencyMode should deactivate emergency mode successfully" name="Emergency Controller deactivateEmergencyMode should deactivate emergency mode successfully" time="0.001">
    </testcase>
    <testcase classname="Emergency Controller getEmergencyHistory should return emergency history with pagination" name="Emergency Controller getEmergencyHistory should return emergency history with pagination" time="0">
    </testcase>
    <testcase classname="Emergency Controller notifyScheduleChange should send schedule change notification" name="Emergency Controller notifyScheduleChange should send schedule change notification" time="0.001">
    </testcase>
  </testsuite>
  <testsuite name="Validation Middleware" errors="0" failures="0" skipped="0" timestamp="2025-12-28T11:09:57" time="0.793" tests="2">
    <testcase classname="Validation Middleware should pass validation when no errors" name="Validation Middleware should pass validation when no errors" time="0.001">
    </testcase>
    <testcase classname="Validation Middleware should return errors when validation fails" name="Validation Middleware should return errors when validation fails" time="0.002">
    </testcase>
  </testsuite>
  <testsuite name="Nutrition Controller" errors="0" failures="10" skipped="0" timestamp="2025-12-28T11:09:54" time="3.382" tests="10">
    <testcase classname="Nutrition Controller getDailyNutritionLog should return daily nutrition log successfully" name="Nutrition Controller getDailyNutritionLog should return daily nutrition log successfully" time="0.029">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:41:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller getDailyNutritionLog should handle service errors" name="Nutrition Controller getDailyNutritionLog should handle service errors" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockRejectedValue&apos;)
    at Object.mockRejectedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:53:36)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller createNutritionGoal should create nutrition goal successfully" name="Nutrition Controller createNutritionGoal should create nutrition goal successfully" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:75:35)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller createNutritionGoal should validate required fields" name="Nutrition Controller createNutritionGoal should validate required fields" time="0">
      <failure>TypeError: nutritionController.createNutritionGoal is not a function
    at Object.createNutritionGoal (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:89:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller getNutritionGoals should return user nutrition goals" name="Nutrition Controller getNutritionGoals should return user nutrition goals" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:102:37)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller updateNutritionGoal should update nutrition goal" name="Nutrition Controller updateNutritionGoal should update nutrition goal" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:124:35)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller getWeeklyReport should return weekly nutrition report" name="Nutrition Controller getWeeklyReport should return weekly nutrition report" time="0">
      <failure>TypeError: nutritionController.getWeeklyReport is not a function
    at Object.getWeeklyReport (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:146:33)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller logMeal should log meal successfully" name="Nutrition Controller logMeal should log meal successfully" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:170:32)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller deleteNutritionGoal should delete nutrition goal" name="Nutrition Controller deleteNutritionGoal should delete nutrition goal" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:186:35)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Nutrition Controller deleteNutritionGoal should handle not found error" name="Nutrition Controller deleteNutritionGoal should handle not found error" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;mockResolvedValue&apos;)
    at Object.mockResolvedValue (/home/user/breakapp/backend/tests/unit/controllers/nutritionController.test.js:200:35)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Auth Controller" errors="0" failures="3" skipped="0" timestamp="2025-12-28T11:09:54" time="3.418" tests="5">
    <testcase classname="Auth Controller register should register user successfully" name="Auth Controller register should register user successfully" time="0.031">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: {&quot;data&quot;: {&quot;token&quot;: &quot;token&quot;, &quot;user&quot;: {&quot;id&quot;: &quot;1&quot;}}, &quot;message&quot;: &quot;تم التسجيل بنجاح&quot;, &quot;success&quot;: true}

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/authController.test.js:29:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Auth Controller register should return validation errors" name="Auth Controller register should return validation errors" time="0.001">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: {&quot;errors&quot;: [{&quot;msg&quot;: &quot;Invalid email&quot;}], &quot;success&quot;: false}

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/authController.test.js:45:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Auth Controller login should login successfully" name="Auth Controller login should login successfully" time="0.002">
      <failure>Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)

Expected: {&quot;data&quot;: {&quot;token&quot;: &quot;token&quot;, &quot;user&quot;: {&quot;id&quot;: &quot;1&quot;}}, &quot;message&quot;: &quot;تم تسجيل الدخول بنجاح&quot;, &quot;success&quot;: true}

Number of calls: 0
    at Object.toHaveBeenCalledWith (/home/user/breakapp/backend/tests/unit/controllers/authController.test.js:60:24)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Auth Controller getCurrentUser should return current user" name="Auth Controller getCurrentUser should return current user" time="0.001">
    </testcase>
    <testcase classname="Auth Controller changePassword should change password successfully" name="Auth Controller changePassword should change password successfully" time="0">
    </testcase>
  </testsuite>
  <testsuite name="E2E Scenario: User Journey" errors="0" failures="1" skipped="0" timestamp="2025-12-28T11:09:54" time="5.288" tests="1">
    <testcase classname="E2E Scenario: User Journey should allow a user to register, login, and create an order" name="E2E Scenario: User Journey should allow a user to register, login, and create an order" time="0.182">
      <failure>Error: expected 201 &quot;Created&quot;, got 500 &quot;Internal Server Error&quot;
    at Object.expect (/home/user/breakapp/backend/tests/e2e/scenario.test.js:146:14)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)
----
    at Test._assertStatus (/home/user/breakapp/backend/node_modules/supertest/lib/test.js:252:14)
    at /home/user/breakapp/backend/node_modules/supertest/lib/test.js:308:13
    at Test._assertFunction (/home/user/breakapp/backend/node_modules/supertest/lib/test.js:285:13)
    at Test.assert (/home/user/breakapp/backend/node_modules/supertest/lib/test.js:164:23)
    at Server.localAssert (/home/user/breakapp/backend/node_modules/supertest/lib/test.js:120:14)
    at Object.onceWrapper (node:events:633:28)
    at Server.emit (node:events:519:28)
    at emitCloseNT (node:net:2419:8)
    at processTicksAndRejections (node:internal/process/task_queues:89:21)</failure>
    </testcase>
  </testsuite>
  <testsuite name="Voice Service" errors="0" failures="22" skipped="0" timestamp="2025-12-28T11:09:54" time="9.486" tests="22">
    <testcase classname="Voice Service processVoiceCommand should process Arabic voice command successfully" name="Voice Service processVoiceCommand should process Arabic voice command successfully" time="0.034">
      <failure>Error: expect(received).toEqual(expected) // deep equality

- Expected  -  9
+ Received  + 16

  Object {
-   &quot;confidence&quot;: 0.95,
-   &quot;extractedItems&quot;: ArrayContaining [
-     ObjectContaining {
-       &quot;name&quot;: StringContaining &quot;برجر&quot;,
-       &quot;quantity&quot;: 1,
+   &quot;action&quot;: &quot;UNKNOWN&quot;,
+   &quot;detectedIntent&quot;: Object {
+     &quot;action&quot;: &quot;UNKNOWN&quot;,
+     &quot;confidence&quot;: 0,
+     &quot;entities&quot;: Array [],
+   },
+   &quot;message&quot;: &quot;I didn&apos;t understand your request, please try again&quot;,
+   &quot;originalText&quot;: Object {
+     &quot;audioData&quot;: &quot;base64-audio-data&quot;,
+     &quot;language&quot;: &quot;ar&quot;,
+     &quot;sessionId&quot;: &quot;session-1&quot;,
    },
+   &quot;sessionId&quot;: &quot;test-uuid-12345&quot;,
+   &quot;suggestions&quot;: Array [
+     &quot;Order my usual&quot;,
+     &quot;I want a burger&quot;,
+     &quot;What are the available options&quot;,
    ],
-   &quot;intent&quot;: &quot;ORDER_ITEM&quot;,
-   &quot;requiresConfirmation&quot;: true,
-   &quot;sessionId&quot;: &quot;session-1&quot;,
-   &quot;transcription&quot;: &quot;أريد برجر مع بطاطس&quot;,
  }
    at Object.toEqual (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:97:22)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Service processVoiceCommand should handle English voice commands" name="Voice Service processVoiceCommand should handle English voice commands" time="0.003">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: &quot;ORDER_ITEM&quot;
Received: undefined
    at Object.toBe (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:123:29)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Service processVoiceCommand should handle low confidence transcription" name="Voice Service processVoiceCommand should handle low confidence transcription" time="0.002">
      <failure>Error: expect(received).toBeLessThan(expected)

Matcher error: received value must be a number or bigint

Received has value: undefined
    at Object.toBeLessThan (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:144:33)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Service processVoiceCommand should extract multiple items from complex commands" name="Voice Service processVoiceCommand should extract multiple items from complex commands" time="0.001">
      <failure>Error: expect(received).toHaveLength(expected)

Matcher error: received value must have a length property whose value must be a number

Received has value: undefined
    at Object.toHaveLength (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:160:37)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)</failure>
    </testcase>
    <testcase classname="Voice Service confirmVoiceOrder should confirm voice order and create actual order" name="Voice Service confirmVoiceOrder should confirm voice order and create actual order" time="0.001">
      <failure>Error: Voice session not found
    at Object.confirmVoiceOrder (/home/user/breakapp/backend/src/services/voiceService.js:414:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at Object.&lt;anonymous&gt; (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:204:22)</failure>
    </testcase>
    <testcase classname="Voice Service confirmVoiceOrder should handle order cancellation" name="Voice Service confirmVoiceOrder should handle order cancellation" time="0">
      <failure>Error: Voice session not found
    at Object.confirmVoiceOrder (/home/user/breakapp/backend/src/services/voiceService.js:414:13)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at Object.&lt;anonymous&gt; (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:240:22)</failure>
    </testcase>
    <testcase classname="Voice Service getUsualOrder should return user most frequent order" name="Voice Service getUsualOrder should return user most frequent order" time="0">
      <failure>TypeError: voiceService.getUsualOrder is not a function
    at Object.getUsualOrder (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:269:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getUsualOrder should return null if no frequent orders found" name="Voice Service getUsualOrder should return null if no frequent orders found" time="0.001">
      <failure>TypeError: voiceService.getUsualOrder is not a function
    at Object.getUsualOrder (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:287:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service voiceSearchMenu should search menu items by voice query" name="Voice Service voiceSearchMenu should search menu items by voice query" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findMany&apos;)
    at Object.findMany [as voiceSearchMenu] (/home/user/breakapp/backend/src/services/voiceService.js:535:43)
    at Object.voiceSearchMenu (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:320:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service voiceSearchMenu should handle fuzzy matching for similar words" name="Voice Service voiceSearchMenu should handle fuzzy matching for similar words" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findMany&apos;)
    at Object.findMany [as voiceSearchMenu] (/home/user/breakapp/backend/src/services/voiceService.js:535:43)
    at Object.voiceSearchMenu (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:351:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service textToSpeech should convert Arabic text to speech" name="Voice Service textToSpeech should convert Arabic text to speech" time="0.503">
      <failure>Error: expect(received).toEqual(expected) // deep equality

- Expected  - 4
+ Received  + 2

  Object {
-   &quot;audioData&quot;: Any&lt;String&gt;,
+   &quot;audioUrl&quot;: &quot;/api/voice/audio/test-uuid-12345.mp3&quot;,
    &quot;duration&quot;: Any&lt;Number&gt;,
-   &quot;format&quot;: &quot;mp3&quot;,
-   &quot;language&quot;: &quot;ar&quot;,
-   &quot;voice&quot;: &quot;female&quot;,
+   &quot;success&quot;: true,
  }
    at Object.toEqual (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:368:22)</failure>
    </testcase>
    <testcase classname="Voice Service textToSpeech should handle English text to speech" name="Voice Service textToSpeech should handle English text to speech" time="0.501">
      <failure>Error: expect(received).toBe(expected) // Object.is equality

Expected: &quot;en&quot;
Received: undefined
    at Object.toBe (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:386:31)</failure>
    </testcase>
    <testcase classname="Voice Service setVoicePreferences should set user voice preferences" name="Voice Service setVoicePreferences should set user voice preferences" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;upsert&apos;)
    at Object.upsert [as setVoicePreferences] (/home/user/breakapp/backend/src/services/voiceService.js:581:54)
    at Object.setVoicePreferences (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:410:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getVoicePreferences should return user voice preferences" name="Voice Service getVoicePreferences should return user voice preferences" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at Object.findUnique [as getVoicePreferences] (/home/user/breakapp/backend/src/services/voiceService.js:606:42)
    at Object.getVoicePreferences (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:432:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getVoicePreferences should return default preferences if none exist" name="Voice Service getVoicePreferences should return default preferences if none exist" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findUnique&apos;)
    at Object.findUnique [as getVoicePreferences] (/home/user/breakapp/backend/src/services/voiceService.js:606:42)
    at Object.getVoicePreferences (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:440:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service createVoiceShortcut should create custom voice shortcut" name="Voice Service createVoiceShortcut should create custom voice shortcut" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;create&apos;)
    at Object.create [as createVoiceShortcut] (/home/user/breakapp/backend/src/services/voiceService.js:620:49)
    at Object.createVoiceShortcut (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:470:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service createVoiceShortcut should validate shortcut phrase uniqueness" name="Voice Service createVoiceShortcut should validate shortcut phrase uniqueness" time="0.014">
      <failure>Error: expect(received).rejects.toThrow(expected)

Expected substring: &quot;Voice shortcut with this phrase already exists&quot;
Received message:   &quot;Cannot read properties of undefined (reading &apos;create&apos;)&quot;

      618 | async function createVoiceShortcut(userId, shortcutData) {
      619 |   try {
    &gt; 620 |     const shortcut = await prisma.voiceShortcut.create({
          |                                                 ^
      621 |       data: {
      622 |         userId,
      623 |         ...shortcutData,

      at Object.create [as createVoiceShortcut] (src/services/voiceService.js:620:49)
      at Object.createVoiceShortcut (tests/unit/services/voiceService.test.js:494:33)
    at Object.toThrow (/home/user/breakapp/backend/node_modules/jest-circus/node_modules/expect/build/index.js:218:22)
    at Object.toThrow (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:495:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getVoiceShortcuts should return user voice shortcuts" name="Voice Service getVoiceShortcuts should return user voice shortcuts" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;findMany&apos;)
    at Object.findMany [as getVoiceShortcuts] (/home/user/breakapp/backend/src/services/voiceService.js:640:39)
    at Object.getVoiceShortcuts (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:518:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service trainPersonalVoiceModel should initiate personal voice model training" name="Voice Service trainPersonalVoiceModel should initiate personal voice model training" time="3.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;create&apos;)
    at Object.create [as trainPersonalVoiceModel] (/home/user/breakapp/backend/src/services/voiceService.js:661:59)
    at Object.&lt;anonymous&gt; (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:543:22)</failure>
    </testcase>
    <testcase classname="Voice Service trainPersonalVoiceModel should require minimum voice samples" name="Voice Service trainPersonalVoiceModel should require minimum voice samples" time="3.004">
      <failure>Error: expect(received).rejects.toThrow(expected)

Expected substring: &quot;Minimum 5 voice samples required for training&quot;
Received message:   &quot;Cannot read properties of undefined (reading &apos;create&apos;)&quot;

      659 |     
      660 |     // حفظ معلومات النموذج
    &gt; 661 |     const personalModel = await prisma.personalVoiceModel.create({
          |                                                           ^
      662 |       data: {
      663 |         userId,
      664 |         modelId,

      at Object.create [as trainPersonalVoiceModel] (src/services/voiceService.js:661:59)
      at Object.&lt;anonymous&gt; (tests/unit/services/voiceService.test.js:560:7)
    at Object.toThrow (/home/user/breakapp/backend/node_modules/jest-circus/node_modules/expect/build/index.js:218:22)
    at Object.toThrow (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:561:18)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getVoiceAnalytics should return comprehensive voice usage analytics" name="Voice Service getVoiceAnalytics should return comprehensive voice usage analytics" time="0.001">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;count&apos;)
    at Object.count [as getVoiceAnalytics] (/home/user/breakapp/backend/src/services/voiceService.js:696:27)
    at Object.getVoiceAnalytics (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:581:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
    <testcase classname="Voice Service getVoiceAnalytics should handle empty analytics data" name="Voice Service getVoiceAnalytics should handle empty analytics data" time="0">
      <failure>TypeError: Cannot read properties of undefined (reading &apos;count&apos;)
    at Object.count [as getVoiceAnalytics] (/home/user/breakapp/backend/src/services/voiceService.js:696:27)
    at Object.getVoiceAnalytics (/home/user/breakapp/backend/tests/unit/services/voiceService.test.js:608:41)
    at Promise.then.completed (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:298:28)
    at new Promise (&lt;anonymous&gt;)
    at callAsyncCircusFn (/home/user/breakapp/backend/node_modules/jest-circus/build/utils.js:231:10)
    at _callCircusTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:316:40)
    at _runTest (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:252:3)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:126:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at _runTestsForDescribeBlock (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:121:9)
    at run (/home/user/breakapp/backend/node_modules/jest-circus/build/run.js:71:3)
    at runAndTransformResultsToJestFormat (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)
    at jestAdapter (/home/user/breakapp/backend/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)
    at runTestInternal (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:367:16)
    at runTest (/home/user/breakapp/backend/node_modules/jest-runner/build/runTest.js:444:34)
    at Object.worker (/home/user/breakapp/backend/node_modules/jest-runner/build/testWorker.js:106:12)</failure>
    </testcase>
  </testsuite>
</testsuites>